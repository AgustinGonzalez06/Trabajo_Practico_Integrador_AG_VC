<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Editar Producto</title>
  <link id="temaCSS" rel="stylesheet" href="/css/stylesProd.css" />
  <link rel="icon" href="/favicon.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
</head>
<body>
  <header>
  <a href="/loginUser.html" style="text-decoration: none; color: inherit;">
  <div class="logo">
    <img src="/favicon.png" alt="Logo ValorantTienda" />
    <h1>ValorantTienda Dashboard</h1>
  </div>
  </a>
  <nav>
      <!-- Botón de tema aparte -->
  <button id="btnTema" class="tema-toggle" aria-label="Cambiar tema">
    <span id="iconoTema" class="material-symbols-outlined">dark_mode</span>
  </button>
  </nav>

</header>
  <main class="formulario-producto">
    <h1>Editar producto</h1>

    <% if (errores && errores.length > 0) { %>
      <ul class="errores">
        <% errores.forEach(err => { %>
          <li><%= err.msg %></li>
        <% }) %>
      </ul>
    <% } %>

    <form action="/admin/editar/<%= datos.id %>" method="POST" enctype="multipart/form-data">
      <label for="nombre">Nombre:</label>
      <input type="text" name="nombre" id="nombre" required minlength="3" maxlength="100" value="<%= datos?.nombre || '' %>" />

      <label for="precio">Precio:</label>
      <input type="number" name="precio" id="precio" required min="1" step="1" value="<%= datos?.precio || '' %>" />

      <label for="categoria">Categoría:</label>
      <select name="categoria" id="categoria" required>
        <option value="moneda" <%= datos?.categoria === 'moneda' ? 'selected' : '' %>>Moneda</option>
        <option value="skin" <%= datos?.categoria === 'skin' ? 'selected' : '' %>>Skin</option>
      </select>

      <label for="subcategoria">Subcategoría:</label>
      <input type="text" name="subcategoria" id="subcategoria" maxlength="50" value="<%= datos?.subcategoria || '' %>" />

      <label for="img">Imagen actual:</label><br>
      <% if (datos.img) { %>
        <img src="<%= datos.img %>" alt="Imagen actual" width="150"><br>
      <% } else { %>
        <p>No hay imagen disponible.</p>
      <% } %>

      <label for="img">Subir nueva imagen (opcional):</label>
      <input type="file" name="img" id="img" accept="image/*" />

      <label for="destacado">
      <input type="checkbox" name="destacado" id="destacado" value="1" <%= datos.destacado ? 'checked' : '' %> />
      Destacado
      </label>
      <button type="submit">Guardar cambios</button>
    </form>

    <a href="/admin/dashboard">⬅️ Volver al dashboard</a>
  </main>
  <footer>
  <div class="logo">
    <img src="/favicon.png" alt="Logo ValorantTienda" />
    <h1>ValorantTienda</h1>
  </div>

  <div class="footer-info">
    <p>Valentin Corallo &nbsp;&nbsp; Agustin Gonzales</p>
    <p>&copy; 2025 ValorantTienda. Todos los derechos reservados.</p>
  </div>
</footer>

<script>
  function aplicarTemaCSS(tema) {
    const linkTema = document.getElementById('temaCSS');
    if (tema === 'oscuro') {
      linkTema.href = '/css/stylesProd.css';
      document.getElementById("iconoTema").textContent = "light_mode";
    } else {
      linkTema.href = '/css/stylesProdclaro.css';
      document.getElementById("iconoTema").textContent = "dark_mode";
    }
    localStorage.setItem("tema", tema);
  }

  document.addEventListener("DOMContentLoaded", () => {
    const temaGuardado = localStorage.getItem("tema");
    aplicarTemaCSS(temaGuardado === 'oscuro' ? 'oscuro' : 'claro');

    const btnTema = document.getElementById("btnTema");
    const iconoTema = document.getElementById("iconoTema");

    if (btnTema && iconoTema) {
      btnTema.addEventListener("click", () => {
        const temaActual = localStorage.getItem("tema");
        const nuevoTema = temaActual === "oscuro" ? "claro" : "oscuro";
        aplicarTemaCSS(nuevoTema);
      });
    }
  });
</script>
</body>
</html>
